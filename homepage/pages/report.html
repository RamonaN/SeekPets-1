<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/report.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" >
     
      <link href="https://fonts.googleapis.com/css?family=Mystery+Quest|Fredericka+the+Great|Flavors&display=swap" rel="stylesheet">
   <link 
   href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" 
   rel="stylesheet"  type='text/css'>
    <title>Pawtaie | Report</title>
    
    
</head>

<body>
    <header style="background:transparent !important">
        <section id="navbar">
            <h6 id="pentruHTMLValid"></h6>
            <a href="home.html" id="logo" target="_blank">
                <img src="images/logo_transparent1.png" alt="logo">
            </a>
            <label for="toggle-1" class="toggle-menu">
                &#9776;
            </label>
            <input type="checkbox" id="toggle-1">
            <nav>
                <ul>
                    <li><a href="home.html"><i class="fas fa-home"></i>Home</a></li>
                    <li><a href="report.html" class="active"><i class="fas fa-search"></i>Report a pet</a></li>
                    <li><a href="news.html"><i class="fas fa-newspaper"></i>News</a></li>
                    <li><a href="profile_page.html" ><i class="fas fa-cogs"></i>Account</a></li>
                    
                    <li><a href="#" id="button"><i class="fas fa-user"></i>Log Out</a></li>
                </ul>
            </nav>
        </section>
        <div class="banner">
        <video autoplay muted loop id="myVideo" style="opacity: 0.7">
                <source src="images/gatos_.mp4" type="video/mp4">
              </video>
            </div> 
        <div class="content" style="z-index:20">
                <div class="main1">
                       
                     <div class = "lostpet-form">
                            <div class="entryFormular ">   
                                    <input type="radio" name="demo" value="one" id="radio-one" class="form-radio" ><label for="radio-one" id="labels">Lost Pet</label>
                            </div>
                            <div class="entryFormular">
                                    <input type="radio" name="demo" value="two" id="radio-two" class="form-radio" ><label for="radio-one" id="labels">Found Pet</label>

                            </div>
                        <form class="registerForm"  method="post">
                             
                            <div class = "entryFormular">
                              <label for="inputNume2" >Name </label>
                              <input type = "text" id = "inputNume2" placeholder = "Tell us the name your pet may respond to">
                           </div>
                           <div class = "entryFormular">
                              <label for="inputRasa2">Race </label>
                              <input type = "text" id = "inputRasa2" placeholder = "Tell us the race of your pet (cat/dog is not enough :) )">
                           </div>
                           <div class = "entryFormularCheck">
                              <label for="inputZgarda2">Collar </label>
                              <input type="checkbox" value="zgarda" id = "inputZgarda2" >
                              <div class = "entryFormularInvizibil">
                                 <label for="inputZgardaDetalii2">Collar description </label>
                                 <input type = "text" id = "inputZgardaDetalii2" placeholder = "Give us a description of the collar (e.g: colour)">
                              </div>
                           </div>
                           <div class = "entryFormular">
                              <label for="inputZona2">Address </label>
                              <input type = "text" name="address"  id = "pac-input" placeholder = "Tell us the address your pet was last seen at">
                           </div>
                           
                              
                           <div class = "entryFormularCheck">
                               
                                
                              <label for="inputReward2">Reward </label>
                              <input type="checkbox" value="reward" id = "inputReward2" >
                              <div class = "entryFormularInvizibilRe">
                                 <label for="inputRewardDetalii2">Reward description </label>
                                 <input type = "text" id = "inputRewardDetalii2" placeholder = "What is the reward?">
                              </div>
                           </div>
                           <div class = "entryFormular">
                              <label for="inputDetalii2">Pet description </label>
                              <textarea id = "inputDetalii2" placeholder="Give us a good description of your pet! "></textarea> 
                           </div>
                           <div class = "entryFormular">
                              <label for="inputEmail2">Contact </label>
                              <input type = "text" id = "inputEmail2" placeholder = "Email, phone, etc">
                           </div>
                           
                           <div class = "entryFormular">
                                <label for="file">Picture </label>
                              <input type="file" name="file" class="inputfile" accept="image/*"  id="filechooser" />

                              <img id="output"  />
                             
                           </div>
                           
                           <input type="button" value="Submit" id="submitform">
                        </form>
                     </div>
                  </div>
               </div>
        
    </header>
     
           
      
  <script>

        // Get the video
        var video = document.getElementById("myVideo");
        
        // Get the button
        var btn = document.getElementById("myBtn");
        
        // Pause and play the video, and change the button text
        function myFunction() {
          if (video.paused) {
            video.play();
        
         
          
          }
        };
      function  functiondisplay(){
        var checkbox= document.getElementById("inputReward2");
        if(checkbox.checked==true)
        {
            document.getElementByClassName('entryFormularInvizibilRe').style.display="flex";
        }
       };
        document.getElementById("output").style.display="none";
    
      </script>
       
  <script>
  document.getElementById('filechooser').addEventListener('change',function(){

  
   const input = document.getElementById('filechooser');
   var fr= new FileReader();
    fr.readAsDataURL(input.files[0]);
    fr.onload = () => {
      var  encoded = fr.result.replace(/^data:(.*;base64,)?/, '');
     
      var formdata= new FormData();
      formdata.append('image',encoded);
      fetch("https://api.imgbb.com/1/upload?key=0e8bd904000c67f37512bbb5c3ccf762",{
         method: 'POST',
         body:formdata
         
      }).then(response=>response.json())
      .then(jsonResp =>{
         console.log(jsonResp);
         document.getElementById('output').style.display="block";
         document.getElementById('output').src=jsonResp.data.display_url;
      })
    };
    
    });
 document.getElementById('submitform').addEventListener('click',function(){
  var status;
    var checkboxFound= document.getElementById('radio-two');
        if(checkboxFound.checked==true){
   
               status='1';
         
        }
   var checkboxLost= document.getElementById('radio-one');
        if(checkboxLost.checked==true){
         status='2';
      }
    
     let  pet_description,contact,  name,race,collar,reward,image;
     name= document.getElementById('inputNume2').value;
     race=document.getElementById('inputRasa2').value;
     contact=document.getElementById('inputEmail2').value;
     pet_description=document.getElementById('inputDetalii2').value;
     collar=document.getElementById('inputZgardaDetalii2').value;
     image=document.getElementById('output').src;
     if(collar==="")
     {
        collar="null";
     }
     reward=document.getElementById('inputRewardDetalii2').value;
      if(reward===""){
         reward="null";
      }
        
        
     
     var PLACENAME= document.getElementById('pac-input').value;
    
  const url = "https://api.opencagedata.com/geocode/v1/json?q="+PLACENAME+"&key=756a6e9ea1f44169814599241a777aac";

    fetch( url)
   .then((result) => result.json())

   .then((jsonResp) => {

      console.log(jsonResp.results[0].formatted);
     var address=jsonResp.results[0].formatted;
    var lat=jsonResp.results[0].geometry.lat;
      var long=jsonResp.results[0].geometry.lng;


 
 
 let data={
    "name":name,
    "race":race,
    "collar":collar,
    "reward":reward,
    "description":pet_description,
    "contact":contact,
    "latitude":lat,
    "longitude":long,
    "status":status,
    "address":address,
    "image": image
 }
 console.log(data);
 let object=JSON.stringify(data);
 fetch('/api/post_announcement',{
    method: "POST",
    headers: {
                'Accept': 'application/json',
                'Bearer': sessionStorage.getItem("accessToken")
                // 'Content-Type': 'application/json'
            },
    body: object
 })
 .then(response=>response.json())
 .then(jsonResp =>{
    alert(jsonResp.data);
 })
 })
 });

  </script>
    </body>
    </html>